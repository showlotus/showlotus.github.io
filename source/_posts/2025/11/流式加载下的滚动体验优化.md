---
title: 流式加载下的滚动体验优化
tags:
  - 待发布
mathjax: false
date: 2025-11-28 11:30:53
categories:
---

在流式加载场景下，每当流式加载有输出新内容时，会自动滚动到页面底部，以展示最新内容。这是在用户不介入的前提下的默认行为。

而当用户开始介入，想要查看历史内容时，需要手动向上滚动，以查看历史内容。这时，如果再自动滚动到页面底部，就会打断用户的阅读节奏，影响用户体验。所以，需要在用户手动滚动时，停止自动滚动的行为。而如果停止自动滚动后，用户又想看最新的内容，由于自动滚动已被停止了，所以就不得不每次都要手动滚动到页面底部。这种体验也是不好的。因此，还需要在一个合适的时机再次恢复自动滚动的行为。

当在用市面上一些大模型产品时，不知道你是否注意到，目前这些产品在流式加载时，都会在用户手动滚动时，停止自动滚动的行为。而当用户手动滚动到页面底部时，会重新恢复自动滚动的行为。这种体验是很好的。

<!-- ![](demo.gif) -->

而这种效果是如何实现的呢？不妨先来分析一下自动滚动触发的时机。

<!-- 关键点就在于：当前滚动条是否在底部。如果在底部，则滚动到底部，否则，不滚动到底部。 -->

每当有新内容输出时，都会自动滚动到页面底部。而当不再有新内容输出时，则会停止自动滚动的行为。

也就是每一次新内容的输出都会有一次自动滚动的行为。

仔细分析就会发现，自动滚动是与流式输出新内容相关联的，

基于这个关键点，先来逐步分解一下整个流程的各个步骤。每当有新内容输出时的流程是：

![](flow1.excalidraw.svg)

而当用户手动滚动时，则会影响下面这个节点的状态：

![](flow2.excalidraw.svg)

但是不会影响整个流程，

虽然用户可以介入的流程节点有更多，但是并非这些流程节点都需要关注，只需要关注触发自动滚动的这个流程节点即可。

![](flow3.excalidraw.svg)

因为只有在这个流程节点中，自动滚动才会和用户的滚动操作产生冲突，其他流程节点中，是不会触发自动滚动的。
