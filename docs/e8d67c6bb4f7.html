<!DOCTYPE html><html class="appearance-light" lang="zh-CN"><head><meta charset="UTF-8"><title>ivu-input-number-union &lt;W7&gt;</title><meta name="description" content="I hope one day, everyone is using my program."><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="


æœ€è¿‘æœ‹å‹é—®æˆ‘ï¼Œå¤šä¸ªæ•°å­—è¾“å…¥æ¡†è”åŠ¨æ€ä¹ˆåšï¼Ÿä»–é‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œè¡¨æ ¼é‡Œçš„æŸä¸€åˆ—æ˜¯è¾“å…¥æ•°å­—è¾“å…¥æ¡†ï¼Œæœ‰å¤šè¡Œï¼Œè€Œæœ€åä¸€è¡Œæ˜¯è¿™äº›æ•°å­—çš„æ€»å’Œã€‚è¦è¾¾åˆ°çš„æ•ˆæœæ˜¯ï¼Œå½“è¾“å…¥æ¡†ä¸­çš„æ•°å­—å’Œè¶…å‡ºæ€»å’Œæ—¶ï¼Œæ¸…ç©ºæ‰€æœ‰è¾“å…¥æ¡†ï¼›å¦‚æœæœªè¶…å‡ºæœ€å¤§å€¼ï¼Œä¸”è¿˜å‰©ä¸€ä¸ªè¾“å…¥æ¡†æœªè¾“å…¥æ—¶ï¼Œè‡ªåŠ¨å¯¹æœ€åä¸€ä¸ªè¾“å…¥æ¡†èµ‹å€¼ã€‚åˆšå¥½å‰ä¸€æ®µæ—¶é—´ï¼Œåšäº†ä¸€ä¸ªä¸‹æ‹‰æ¡†è”åŠ¨çš„ï¼Œä¸¤è€…çš„å¤§ä½“æ€è·¯æ˜¯ç›¸åŒçš„ã€‚é¦–å…ˆæ˜¯é‡‡ç”¨æŒ‡ä»¤å»å®ç°ï¼Œè¿‡ç¨‹ç¨ç¨æœ‰ç‚¹å¤æ‚ï¼Œäºæ˜¯æœ€ååˆå®ç°äº†ä¸€ä¸ªäºŒæ¬¡å°è£…ç»„ä»¶çš„ç‰ˆæœ¬ã€‚ï¼ˆä¸‹é¢ç›´æ¥é€šè¿‡ iframe å¼•ç”¨äº† codepen ä¸Šå†™å¥½çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼Œå¯ä»¥è¯•ä¸€è¯•ï¼‰



æŒ‡ä»¤ç‰ˆæœ¬æ€è·¯å¤šä¸ªç»„ä»¶è”åŠ¨ï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯éœ€è¦æœ‰ä¸€ä¸ªã€ç»„ã€‘çš„æ¦‚å¿µï¼Œç”¨æ¥è®°å½•è¿™äº›ç»„ä»¶çš„ä¿¡æ¯ã€‚è€Œè¦æŠŠå¤šä¸ªç»‘å®šç›¸åŒæŒ‡ä»¤çš„ç»„ä»¶è”ç³»èµ·æ¥ï¼Œå°±éœ€è¦é€šè¿‡å®ƒä»¬çš„ç»„ä»¶ä¸Šä¸‹æ–‡å®ä¾‹è¿›è¡Œè”ç³»ï¼Œä¹Ÿå³ï¼Œè¦æŠŠã€ç»„ã€‘çš„ä¿¡æ¯æŒ‚åœ¨å½“å‰ Vue å®ä¾‹ä¸Šï¼Œè¿™æ ·ç»‘.."><meta name="generator" content="Hexo 5.4.2"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">showlotus's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">ivu-input-number-union &lt;W7&gt;</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">ç‚¹å‡»è¿”å›é¡¶éƒ¨</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">é¦–é¡µ</a></h3><h3 class="is-inline-block"><a href="/archives">å½’æ¡£</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">é¦–é¡µ</a></h3><h3 class="is-inline-block"><a href="/archives">å½’æ¡£</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E7%89%88%E6%9C%AC"><span class="toc-text">æŒ‡ä»¤ç‰ˆæœ¬</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-text">æ€è·¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E4%BB%A3%E7%A0%81"><span class="toc-text">æ•´ä½“ä»£ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%86%E8%8A%82%E6%96%B9%E9%9D%A2"><span class="toc-text">ç»†èŠ‚æ–¹é¢</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%89%88%E6%9C%AC"><span class="toc-text">ç»„ä»¶ç‰ˆæœ¬</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E6%8C%87%E4%BB%A4%E7%89%88%E6%9C%AC%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="toc-text">ä¸æŒ‡ä»¤ç‰ˆæœ¬çš„å·®å¼‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%9D%E5%A4%96%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">é¢å¤–é‡åˆ°çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E4%BB%A3%E7%A0%81-1"><span class="toc-text">æ•´ä½“ä»£ç </span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/ivu-0extends"><i class="tag post-item-tag">ivu-extends</i></a><a href="/tags/ivu-0input-0number"><i class="tag post-item-tag">ivu-input-number</i></a><a href="/tags/ViewDesign"><i class="tag post-item-tag">ViewDesign</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">ivu-input-number-union &lt;W7&gt;</h1><time class="has-text-grey custom-date-font" datetime="2022-10-15T19:51:58.000Z">2022/10/15 19:51</time><article class="mt-2 post-content"><img src="/e8d67c6bb4f7/banner.jpg" class="">

<blockquote>
<p>æœ€è¿‘æœ‹å‹é—®æˆ‘ï¼Œå¤šä¸ªæ•°å­—è¾“å…¥æ¡†è”åŠ¨æ€ä¹ˆåšï¼Ÿä»–é‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œè¡¨æ ¼é‡Œçš„æŸä¸€åˆ—æ˜¯è¾“å…¥æ•°å­—è¾“å…¥æ¡†ï¼Œæœ‰å¤šè¡Œï¼Œè€Œæœ€åä¸€è¡Œæ˜¯è¿™äº›æ•°å­—çš„æ€»å’Œã€‚è¦è¾¾åˆ°çš„æ•ˆæœæ˜¯ï¼Œå½“è¾“å…¥æ¡†ä¸­çš„æ•°å­—å’Œè¶…å‡ºæ€»å’Œæ—¶ï¼Œæ¸…ç©ºæ‰€æœ‰è¾“å…¥æ¡†ï¼›å¦‚æœæœªè¶…å‡ºæœ€å¤§å€¼ï¼Œä¸”è¿˜å‰©ä¸€ä¸ªè¾“å…¥æ¡†æœªè¾“å…¥æ—¶ï¼Œè‡ªåŠ¨å¯¹æœ€åä¸€ä¸ªè¾“å…¥æ¡†èµ‹å€¼ã€‚åˆšå¥½å‰ä¸€æ®µæ—¶é—´ï¼Œåšäº†ä¸€ä¸ªä¸‹æ‹‰æ¡†è”åŠ¨çš„ï¼Œä¸¤è€…çš„å¤§ä½“æ€è·¯æ˜¯ç›¸åŒçš„ã€‚é¦–å…ˆæ˜¯é‡‡ç”¨æŒ‡ä»¤å»å®ç°ï¼Œè¿‡ç¨‹ç¨ç¨æœ‰ç‚¹å¤æ‚ï¼Œäºæ˜¯æœ€ååˆå®ç°äº†ä¸€ä¸ªäºŒæ¬¡å°è£…ç»„ä»¶çš„ç‰ˆæœ¬ã€‚ï¼ˆä¸‹é¢ç›´æ¥é€šè¿‡ iframe å¼•ç”¨äº† codepen ä¸Šå†™å¥½çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼Œå¯ä»¥è¯•ä¸€è¯•ï¼‰</p>
</blockquote>
<div class="iframe-codepen" src="https://codepen.io/olderk/full/eYrQBVm" width="100%" height="500"></div>

<h2 id="æŒ‡ä»¤ç‰ˆæœ¬"><a href="#æŒ‡ä»¤ç‰ˆæœ¬" class="headerlink" title="æŒ‡ä»¤ç‰ˆæœ¬"></a>æŒ‡ä»¤ç‰ˆæœ¬</h2><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å¤šä¸ªç»„ä»¶è”åŠ¨ï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯éœ€è¦æœ‰ä¸€ä¸ªã€ç»„ã€‘çš„æ¦‚å¿µï¼Œç”¨æ¥è®°å½•è¿™äº›ç»„ä»¶çš„ä¿¡æ¯ã€‚è€Œè¦æŠŠå¤šä¸ªç»‘å®šç›¸åŒæŒ‡ä»¤çš„ç»„ä»¶è”ç³»èµ·æ¥ï¼Œå°±éœ€è¦é€šè¿‡å®ƒä»¬çš„ç»„ä»¶ä¸Šä¸‹æ–‡å®ä¾‹è¿›è¡Œè”ç³»ï¼Œä¹Ÿå³ï¼Œè¦æŠŠã€ç»„ã€‘çš„ä¿¡æ¯æŒ‚åœ¨å½“å‰ Vue å®ä¾‹ä¸Šï¼Œè¿™æ ·ç»‘å®šåœ¨åŒä¸€ä¸ªç»„ä¸‹çš„æ¯ä¸ªç»„ä»¶éƒ½èƒ½è®¿é—®åˆ°è¿™ä¸ªã€ç»„ã€‘é‡Œçš„ä¿¡æ¯äº†ã€‚ä¸ºäº†æ–¹ä¾¿åˆ†ç»„ï¼Œéœ€è¦åœ¨æŒ‡ä»¤é‡Œä¼ å…¥ä¸€ä¸ªç»„åï¼Œè¿™é‡Œé€šè¿‡æŒ‡ä»¤çš„ <code>arg</code> å‚æ•°ä¼ å…¥ç»„åã€‚</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>InputNumber v<span class="token operator">-</span>input<span class="token operator">-</span>number<span class="token operator">-</span>union<span class="token operator">:</span>group1<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>InputNumber<span class="token operator">></span></code></pre>

<p>åœ¨æŒ‡ä»¤çš„ <code>bind</code> é˜¶æ®µï¼Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼š</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>
  <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> arg <span class="token punctuation">&#125;</span> <span class="token operator">=</span> binding
    <span class="token keyword">const</span> groupName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_ivu-input-number-union-group-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>arg<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> vnode<span class="token punctuation">.</span>context
    <span class="token keyword">const</span> group <span class="token operator">=</span> <span class="token punctuation">(</span>that<span class="token punctuation">[</span>groupName<span class="token punctuation">]</span> <span class="token operator">=</span> that<span class="token punctuation">[</span>groupName<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>å…‰æŒ‚è½½è¿˜ä¸è¡Œï¼Œè¿˜è¦æŠŠå½“å‰ç»„ä»¶çš„å®æ—¶ä¿¡æ¯åŒæ­¥åˆ°ã€ç»„ã€‘ä¸­ï¼Œä¹Ÿå³ï¼Œéœ€è¦ç›‘å¬æ¯ä¸ªè¾“å…¥æ¡†çš„å€¼å˜åŒ–ï¼Œå°†å˜åŒ–åŒæ­¥åˆ°ã€ç»„ã€‘ä¸­ã€‚åªç›‘å¬ä¹Ÿä¸è¡Œï¼Œå¦‚æœå½“å‰ç»„ä»¶è¢«å¸è½½äº†ï¼Œé‚£ä¹ˆç›‘å¬è¿˜å­˜åœ¨ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¸€äº› <em>SideEffect</em> ã€‚æ‰€ä»¥ï¼Œè¿˜è¦åœ¨æŒ‡ä»¤çš„è§£ç»‘é˜¶æ®µï¼Œç§»é™¤ç›‘å¬ã€‚åœ¨æŒ‡ä»¤ä¸­ç›‘å¬å±æ€§ï¼Œé‡‡ç”¨çš„æ˜¯ <em>Vue</em> çš„ <code>$watch</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ‰§è¡Œå®Œåä¼šè¿”å›ä¸€ä¸ªå¸è½½çš„æ–¹æ³•ï¼Œæ‰§è¡Œè¿™ä¸ªæ–¹æ³•å°±ä¼šå°†ç›‘å¬ä»ç›‘å¬å¯¹è±¡çš„ä¾èµ–ä¸­ç§»é™¤ã€‚å› æ­¤ï¼Œè¿˜éœ€è¦ä¿å­˜è¿™äº›ç›‘å¬è¿”å›çš„æ–¹æ³•ã€‚ä¸ <code>group</code> ç±»ä¼¼ï¼Œä¹Ÿè¦æŒ‚åœ¨å½“å‰ç»„ä»¶ä¸Šä¸‹æ–‡ä¸­ã€‚</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>
  <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/* ... */</span>
    <span class="token keyword">const</span> watcherName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>groupName<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">-watch</span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> vnode<span class="token punctuation">.</span>context
    <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token punctuation">(</span>that<span class="token punctuation">[</span>watcherName<span class="token punctuation">]</span> <span class="token operator">=</span> that<span class="token punctuation">[</span>watcherName<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>è¿™ä¸ªç›‘å¬å¯¹è±¡ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæ™®é€šå±æ€§ï¼Œä¹Ÿå¯èƒ½æ˜¯æŸä¸ªå¯¹è±¡ä¸‹çš„å±æ€§ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥æ˜¯ <code>value</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯ <code>obj.value</code>ã€‚è¿™ä¸¤ç§å½¢å¼ï¼Œ<code>$watch</code> éƒ½å¯ä»¥ç›‘å¬å¾—åˆ°ï¼Œå‰ææ˜¯éœ€è¦åœ¨æŒ‡ä»¤ä¸­æä¾›è¿™ä¸ªå±æ€§çš„é“¾å¼å­—ç¬¦ä¸²ã€‚</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>InputNumber v<span class="token operator">-</span>input<span class="token operator">-</span>number<span class="token operator">-</span>union<span class="token operator">:</span>group1<span class="token operator">=</span><span class="token string">"&#123; value: 'value' &#125;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>InputNumber<span class="token operator">></span>
<span class="token comment">// æˆ–è€…</span>
<span class="token operator">&lt;</span>InputNumber v<span class="token operator">-</span>input<span class="token operator">-</span>number<span class="token operator">-</span>union<span class="token operator">:</span>group1<span class="token operator">=</span><span class="token string">"&#123; value: 'obj.value' &#125;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>InputNumber<span class="token operator">></span></code></pre>

<p>çŸ¥é“è¿™ä¸ªéœ€è¦ç›‘å¬çš„å±æ€§åï¼Œå°±å¯ä»¥æ”¶é›†ç›‘å¬äº†ã€‚åŒæ ·åœ¨ <code>unbind</code> é˜¶æ®µï¼Œå¸è½½å¯¹åº”çš„ç›‘å¬ã€‚</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>
  <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/* ... */</span>
    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">value</span><span class="token operator">:</span> key <span class="token punctuation">&#125;</span> <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
    <span class="token comment">// æ”¶é›†ç›‘å¬</span>
    watcher<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> that<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      group<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newVal
      <span class="token comment">/* ... */</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function">unbind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">value</span><span class="token operator">:</span> key <span class="token punctuation">&#125;</span> <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
    <span class="token keyword">const</span> that <span class="token operator">=</span> vnode<span class="token punctuation">.</span>context
    <span class="token comment">// è§£ç»‘æŒ‡ä»¤æ—¶ï¼Œå¸è½½ç›‘å¬ï¼Œç§»é™¤ watcher ä¸­çš„å±æ€§</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      watcher<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">delete</span> watcher<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>æ¥ä¸‹æ¥å°±æ˜¯ç›‘å¬å‡½æ•°å†…éƒ¨çš„é€»è¾‘ï¼ˆé‡ä¸­ä¹‹é‡ï¼‰ï¼Œåˆ—ä¸€ä¸‹æ•´ä½“æ­¥éª¤ï¼š</p>
<ul>
<li>å°†æœ€æ–°çš„å€¼æ›´æ–°åˆ°ã€ç»„ã€‘ä¸­ï¼›</li>
<li>ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼š<ul>
<li>å¦‚æœæ–°å€¼ä¸º <code>null</code>ï¼Œè¯´æ˜æ˜¯èµ‹ç©ºæ“ä½œï¼Œç›´æ¥ <code>return</code>ï¼›</li>
<li>å¦‚æœç»„ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œç›´æ¥æå‰ <code>return</code>ï¼›</li>
<li>å¦‚æœç»„ä¸­æœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œå½“å‰å€¼å˜åŒ–æ—¶ï¼Œç›´æ¥æ›´æ–°å¦ä¸€ä¸ªå€¼ï¼›</li>
<li>å¦‚æœæ—§å€¼ä¸º <code>null</code>ï¼Œå¹¶ä¸”æœªå¡«å†™çš„è¾“å…¥æ¡†æ•°é‡ä¸º 0ï¼Œè¯´æ˜æ˜¯å¯¹æœ€åä¸€ä¸ªè¾“å…¥æ¡†è‡ªåŠ¨èµ‹å€¼ï¼Œç›´æ¥ <code>return</code>ï¼›</li>
</ul>
</li>
<li>å¦‚æœå½“å‰å·²å¡«å†™å€¼çš„å’Œå¤§äºæœ€å¤§å€¼ï¼Œåˆ™å…¨éƒ¨èµ‹ç©ºï¼Œç„¶å <code>return</code>ï¼›</li>
<li>å¦‚æœå½“å‰æœªå¡«å†™å€¼çš„è¾“å…¥æ¡†ä¸ªæ•°ä¸º 1ï¼Œåˆ™å¯¹æœ€åä¸€ä¸ªè¾“å…¥æ¡†è‡ªåŠ¨èµ‹å€¼ï¼ˆæœ€å¤§å€¼ - å½“å‰å’Œï¼‰ã€‚</li>
</ul>
<h3 id="æ•´ä½“ä»£ç "><a href="#æ•´ä½“ä»£ç " class="headerlink" title="æ•´ä½“ä»£ç "></a>æ•´ä½“ä»£ç </h3><blockquote>
<p>åœ¨ <a target="_blank" rel="noopener" href="https://codepen.io/olderk/pen/eYrQBVm">codepen.io</a> ä¸­è¿è¡Œã€‚</p>
</blockquote>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// input-number-union.js</span>
<span class="token keyword">const</span> <span class="token function-variable function">noop</span> <span class="token operator">=</span> <span class="token parameter">v</span> <span class="token operator">=></span> v

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>
  <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> arg<span class="token punctuation">,</span> value <span class="token punctuation">&#125;</span> <span class="token operator">=</span> binding
    <span class="token keyword">const</span> groupName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_ivu-input-number-union-group-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>arg<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">const</span> watcherName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>groupName<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">-watch</span><span class="token template-punctuation string">`</span></span>
    el<span class="token punctuation">.</span>_group <span class="token operator">=</span> groupName
    el<span class="token punctuation">.</span>_watcher <span class="token operator">=</span> watcherName
    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> max<span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> key <span class="token punctuation">&#125;</span> <span class="token operator">=</span> value
    el<span class="token punctuation">.</span>_key <span class="token operator">=</span> key
    <span class="token keyword">const</span> that <span class="token operator">=</span> vnode<span class="token punctuation">.</span>context
    <span class="token keyword">const</span> group <span class="token operator">=</span> <span class="token punctuation">(</span>that<span class="token punctuation">[</span>groupName<span class="token punctuation">]</span> <span class="token operator">=</span> that<span class="token punctuation">[</span>groupName<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token punctuation">(</span>that<span class="token punctuation">[</span>watcherName<span class="token punctuation">]</span> <span class="token operator">=</span> that<span class="token punctuation">[</span>watcherName<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    group<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getVal</span><span class="token punctuation">(</span>that<span class="token punctuation">,</span> key<span class="token punctuation">)</span>

    <span class="token comment">// æ”¶é›†ç›‘å¬</span>
    watcher<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> that<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      group<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newVal
      <span class="token comment">// å¦‚æœæ–°å€¼ä¸º null è¯´æ˜æ˜¯æ¸…ç©ºæ“ä½œï¼Œä¸éœ€è¦èµ°ä¸‹é¢çš„é€»è¾‘</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

      <span class="token keyword">const</span> groupLen <span class="token operator">=</span> <span class="token function">getGroupLen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>groupLen <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>groupLen <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// å¦‚æœåªæœ‰ä¸¤ä¸ªè¾“å…¥æ¡†æ—¶ï¼Œç‰¹åˆ«å¤„ç†</span>
        <span class="token comment">// ä¸€ä¸ªè¾“å…¥æ¡†æ”¹å˜ï¼Œç›´æ¥æ›´æ–°å¦ä¸€ä¸ªæ¡†çš„å€¼</span>
        <span class="token function">updateOtherKey</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> newVal<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">&#125;</span>

      <span class="token keyword">const</span> currSum <span class="token operator">=</span> <span class="token function">getCurrSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// æ±‚å’Œåï¼Œå¤§äºæœ€å¤§å€¼æ—¶ï¼Œèµ‹ç©ºæ‰€æœ‰å€¼</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currSum <span class="token operator">></span> max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">clearAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">&#125;</span>

      <span class="token keyword">const</span> noEditKeys <span class="token operator">=</span> <span class="token function">hasNoEditKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> noEditKeysLen <span class="token operator">=</span> noEditKeys<span class="token punctuation">.</span>length
      <span class="token comment">// å¯¹æœ€åä¸€ä¸ªè¾“å…¥æ¡†è‡ªåŠ¨èµ‹å€¼</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>noEditKeysLen <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">setVal</span><span class="token punctuation">(</span>that<span class="token punctuation">,</span> noEditKeys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> max <span class="token operator">-</span> currSum<span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">getGroupLen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">.</span>length
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function">hasNoEditKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=></span> group<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function">getCurrSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sum<span class="token punctuation">,</span> curr</span><span class="token punctuation">)</span> <span class="token operator">=></span> sum <span class="token operator">+</span> curr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function">clearAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token function">setVal</span><span class="token punctuation">(</span>that<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function">updateOtherKey</span><span class="token punctuation">(</span><span class="token parameter">currKey<span class="token punctuation">,</span> currVal</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currVal <span class="token operator">></span> max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">const</span> otherKey <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>group<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=></span> v <span class="token operator">!==</span> currKey<span class="token punctuation">)</span>
      <span class="token function">setVal</span><span class="token punctuation">(</span>that<span class="token punctuation">,</span> otherKey<span class="token punctuation">,</span> max <span class="token operator">-</span> currVal<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function">getVal</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> keys</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> seqs <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> seqs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">o<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=></span> o<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">function</span> <span class="token function">setVal</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> keys<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> seqs <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>seqs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        obj<span class="token punctuation">[</span>keys<span class="token punctuation">]</span> <span class="token operator">=</span> val
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> seqs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token keyword">const</span> key <span class="token operator">=</span> seqs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!==</span> seqs<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            obj <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
          <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val
          <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function">unbind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>watcher<span class="token punctuation">,</span> groupName<span class="token punctuation">,</span> key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>el<span class="token punctuation">.</span>_watcher<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_group<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_key<span class="token punctuation">]</span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> vnode<span class="token punctuation">.</span>context

    <span class="token comment">// ç»„ä»¶å¸è½½æ—¶ï¼Œå¸è½½ç›‘å¬ï¼Œç§»é™¤ group ä¸­çš„å±æ€§</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">[</span>watcher<span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      that<span class="token punctuation">[</span>watcher<span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">delete</span> that<span class="token punctuation">[</span>watcher<span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token keyword">delete</span> that<span class="token punctuation">[</span>groupName<span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">delete</span> el<span class="token punctuation">.</span>_watcher
    <span class="token keyword">delete</span> el<span class="token punctuation">.</span>_group
    <span class="token keyword">delete</span> el<span class="token punctuation">.</span>_key

    <span class="token comment">// å½“è¯¥ç»„ä¸‹çš„è¾“å…¥æ¡†éƒ½æ¸…ç©ºåï¼Œç§»é™¤æŒ‚è½½çš„å±æ€§</span>
    <span class="token function">tryRemoveKey</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span>
    <span class="token function">tryRemoveKey</span><span class="token punctuation">(</span>groupName<span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">tryRemoveKey</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>that<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>that<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">delete</span> that<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="ç»†èŠ‚æ–¹é¢"><a href="#ç»†èŠ‚æ–¹é¢" class="headerlink" title="ç»†èŠ‚æ–¹é¢"></a>ç»†èŠ‚æ–¹é¢</h3><ul>
<li>æ¯”å¦‚ä¸€äº›åœ¨ <code>unbind</code> å’Œ <code>bind</code> é˜¶æ®µéƒ½ç”¨åˆ°çš„å˜é‡ï¼Œå¯ä»¥ç›´æ¥åœ¨ <code>bind</code> é˜¶æ®µæŒ‚è½½åœ¨å½“å‰çš„ <code>Element</code> å¯¹è±¡ä¸Šã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä¸éœ€è¦åœ¨ <code>unbind</code> é˜¶æ®µå†å†™ä¸€éè·å–å€¼çš„é€»è¾‘ï¼Œæ³¨æ„åœ¨æŒ‡ä»¤è§£ç»‘æ—¶ï¼ŒæŠŠæ³¨å†Œçš„å±æ€§åˆ é™¤ï¼Œä»¥é˜²å†…å­˜æ³„æ¼ï¼›</li>
<li>åœ¨å½“å‰ç»„ä»¶ä¸Šä¸‹æ–‡æ·»åŠ ä¸€ä¸ªæ–°å±æ€§ï¼Œä¸ºäº†é˜²æ­¢å˜é‡åé‡å¤ï¼Œè¿™é‡Œæ²¡æœ‰é‡‡ç”¨ <code>Symbol</code> ç±»å‹ã€‚å› ä¸ºè¦åœ¨ç¡®ä¿åŒç»„ä¸‹çš„ç»„ä»¶éƒ½èƒ½è®¿é—®åˆ°åŒä¸€ä¸ªç»„ï¼Œè€Œæ¯ä¸ªç»„ä»¶éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥å°±æ²¡æœ‰ä½¿ç”¨ <code>Symbol</code> ç±»å‹ã€‚ä¸€èˆ¬å°±æ˜¯ä»¥ä¸€ä¸ªå‡ ä¹ä¸ä¼šé‡å¤çš„åç§°å½“ä½œå‰ç¼€ï¼Œç¡®ä¿å”¯ä¸€å³å¯ï¼›</li>
<li>ä¸ºäº†ç¡®ä¿ç”¨æˆ·æ“ä½œæ—¶ä¸ä¼šæœ‰ä¸€äº›é¢å¤–çš„å½±å“ï¼Œå¼€å¯äº†è¾“å…¥æ¡†å¤±ç„¦æ—¶æ‰å»æ›´æ–°å½“å‰å€¼ã€‚</li>
</ul>
<h2 id="ç»„ä»¶ç‰ˆæœ¬"><a href="#ç»„ä»¶ç‰ˆæœ¬" class="headerlink" title="ç»„ä»¶ç‰ˆæœ¬"></a>ç»„ä»¶ç‰ˆæœ¬</h2><h3 id="ä¸æŒ‡ä»¤ç‰ˆæœ¬çš„å·®å¼‚"><a href="#ä¸æŒ‡ä»¤ç‰ˆæœ¬çš„å·®å¼‚" class="headerlink" title="ä¸æŒ‡ä»¤ç‰ˆæœ¬çš„å·®å¼‚"></a>ä¸æŒ‡ä»¤ç‰ˆæœ¬çš„å·®å¼‚</h3><ul>
<li>å…³äº <code>group</code> å’Œ <code>key</code> çš„ä¼ å‚éƒ½é€šè¿‡ <code>props</code> ä¼ å…¥ã€‚ç”±äº <em>Vue</em> å†…éƒ¨ä¸å…è®¸ä½¿ç”¨ <code>key</code> å…³é”®å­—ä½œä¸ºå±æ€§åï¼Œå°±æ¢æˆäº† <code>iKey</code>ï¼›</li>
<li>ä¸éœ€è¦è€ƒè™‘ä¾èµ–çš„å¸è½½ã€‚å› ä¸ºæ˜¯åœ¨ç»„ä»¶å†…éƒ¨ç›‘å¬ï¼Œå¸è½½ä¼šéšç€ç»„ä»¶ç”Ÿå‘½å‘¨æœŸçš„ç»“æŸè€Œè‡ªè¡Œç§»é™¤ç›‘å¬ã€‚</li>
</ul>
<h3 id="é¢å¤–é‡åˆ°çš„é—®é¢˜"><a href="#é¢å¤–é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é¢å¤–é‡åˆ°çš„é—®é¢˜"></a>é¢å¤–é‡åˆ°çš„é—®é¢˜</h3><p>åœ¨å¯¹æ‰€æœ‰å€¼èµ‹ç©ºæ—¶ï¼Œå‡ºç°äº†ä¸€ç‚¹å°é—®é¢˜ã€‚å½“æ€»å’Œè¶…å‡ºæœ€å¤§å€¼æ—¶ï¼Œä¸ä¼šå¯¹å½“å‰ç¼–è¾‘çš„æœ€åä¸€ä¸ªè¾“å…¥æ¡†èµ‹ç©ºï¼Ÿ</p>
<img src="/e8d67c6bb4f7/problem.gif" class="">

<p>ç›‘å¬çš„å†…éƒ¨é€»è¾‘å’ŒæŒ‡ä»¤ç‰ˆæœ¬çš„å†…éƒ¨é€»è¾‘ä¸€æ¨¡ä¸€æ ·ï¼Œæ€ä¹ˆåˆ°ç»„ä»¶è¿™é‡Œå°±ä¸è¡Œäº†ï¼Ÿè¯•äº†åœ¨å„ç§ç»„ä»¶å®ä¾‹ä¸Šä½¿ç”¨ <code>$forceUpdate</code> éƒ½ä¸è¡Œï¼Œæœ€åè¯¯æ‰“è¯¯æ’è¯•å‡ºæ¥çš„è§£å†³åŠæ³•æ˜¯ï¼Œç”¨ <code>$nextTick</code> æŠŠ <code>clearAll</code> æ–¹æ³•åŒ…èµ·æ¥ã€‚</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">/* ... */</span>
<span class="token keyword">const</span> currSum <span class="token operator">=</span> <span class="token function">getCurrSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// æ±‚å’Œåï¼Œå¤§äºæœ€å¤§å€¼æ—¶ï¼Œèµ‹ç©ºæ‰€æœ‰å€¼</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>currSum <span class="token operator">></span> max<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">clearAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/* ... */</span></code></pre>

<p>ä»”ç»†æ€è€ƒäº†ä¸€ä¸‹ï¼Œæ–°å¢çš„è¾“å…¥æ¡†åˆå§‹å€¼ä¸º <code>null</code>ï¼Œç„¶åå½“å®ƒè¾“å…¥äº†ä¸€ä¸ªå€¼ï¼ˆå®ƒçš„å€¼ç”± <code>null -&gt; newVal</code>ï¼‰ï¼Œå¯¼è‡´å½“å‰å’Œå¤§äºæœ€å¤§å€¼ï¼Œç„¶åå°±ä¼šæ‰§è¡Œ <code>clearAll</code> æ–¹æ³•ï¼Œå°†æ‰€æœ‰è¾“å…¥æ¡†èµ‹ç©ºï¼Œå®ƒçš„å€¼åˆä» <code>newVal -&gt; null</code>ï¼Œä¹Ÿå³ <code>null -&gt; newVal -&gt; null</code>ã€‚è¿™ä¸€ç³»åˆ—æ“ä½œéƒ½æ˜¯åœ¨ä¸€è½®äº‹ä»¶å¾ªç¯é‡Œï¼Œè€Œ <em>Vue</em> å†…éƒ¨ä¼šå¯¹åŒä¸€è½®äº‹ä»¶å¾ªç¯ä¸­å¤šæ¬¡è§¦å‘çš„å›è°ƒï¼Œè¿›è¡Œä¼˜åŒ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ä¹Ÿå³è™½ç„¶è¾“å…¥æ¡†çš„å€¼æ”¹å˜äº†ä¸¤æ¬¡ï¼Œæœ€åä¹Ÿåªä¼šè°ƒç”¨ä¸€æ¬¡å›è°ƒã€‚</p>
<p>åœ¨ <code>watch</code> é‡Œæ‰“å°äº†ä¸€ä¸‹ï¼Œç„¶è€Œç»“æœæ˜¯å®ƒæ‰§è¡Œäº†ä¸¤æ¬¡å›è°ƒï¼š</p>
<ol>
<li><code>null -&gt; newVal</code>ï¼›</li>
<li><code>newVal -&gt; null</code>ã€‚</li>
</ol>
<p>ç†è§£é”™äº†å—ï¼Ÿå…¶å®ä¹Ÿä¸å®Œå…¨é”™ï¼Œæ€è·¯æ˜¯å¯¹çš„ï¼Œå› ä¸ºå€¼å˜åŒ–äº†ä¸¤æ¬¡ï¼Œ<code>watch</code> é‡Œçš„æ‰“å°ä¹Ÿå¾ˆåˆç†ã€‚ä¸è¿‡è¿™ä¸ªã€åªæ‰§è¡Œä¸€æ¬¡çš„å›è°ƒã€‘åœ¨è¿™é‡Œå°±ä¸æ˜¯ <code>watch</code> ä¸­çš„ç›‘å¬å‡½æ•°ï¼Œè€Œæ˜¯è§¦å‘ <code>render</code> çš„å›è°ƒã€‚åœ¨ <code>updated</code> é‡Œæ‰“å°æ—¥å¿—ï¼Œå‘ç°åªä¼šæ‰“å°ä¸€æ¬¡ã€‚<em>Vue</em> ä¼šå°†åŒä¸€è½®äº‹ä»¶å¾ªç¯ä¸­çš„å›è°ƒå…¨éƒ¨æ‰§è¡Œå®Œä¹‹åï¼Œæ‰ä¼šè°ƒç”¨ <code>render</code> å»æ›´æ–°è§†å›¾ï¼Œé˜²æ­¢é¢‘ç¹æ›´æ–°è§†å›¾ï¼Œé€ æˆä¸€äº›æ²¡å¿…è¦çš„æ•ˆç‡é—®é¢˜ã€‚ç„¶è€Œåœ¨ä½¿ç”¨ <code>$nextTick</code> åï¼Œ<code>updated</code> é‡Œçš„æ—¥å¿—å°±ä¼šæ‰“å°ä¸¤æ¬¡ï¼Œä¹Ÿå³ <code>render</code> å‡½æ•°è§¦å‘äº†ä¸¤æ¬¡ã€‚ä¸ºä»€ä¹ˆæ·»åŠ äº† <code>$nextTick</code> åå°±èƒ½æ›´æ–°è§†å›¾äº†å‘¢ï¼Ÿ</p>
<p>æœªä½¿ç”¨ <code>$nextTick</code> å‰ï¼Œç”±äºå®ƒçš„å€¼åœ¨è¿™ä¸€ç³»åˆ—æ“ä½œä¸‹æ¥ï¼Œè¿˜æ˜¯å’Œåˆå§‹å€¼ç›¸åŒï¼Œåœ¨ <em>diff</em> æ—¶ï¼Œå°±è®¤ä¸ºè¿™ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ²¡æœ‰æ›´æ–°èŠ‚ç‚¹ï¼Œç›´æ¥å¤ç”¨ï¼Œä»è€Œå¯¼è‡´è§†å›¾æ²¡æœ‰æ›´æ–°ã€‚è€Œåœ¨ä½¿ç”¨ <code>$nextTick</code> åï¼Œå¯¹äºè§¦å‘çš„ä¸¤æ¬¡ <code>render</code> å…ˆå‘½åä¸€ä¸‹ï¼šè¿™é‡Œå°† <code>null -&gt; newVal</code> é˜¶æ®µçš„æ¸²æŸ“å‘½åä¸º <code>renderA</code>ï¼Œ<code>newVal -&gt; null</code> é˜¶æ®µçš„æ¸²æŸ“å‘½åä¸º <code>renderB</code>ã€‚</p>
<ul>
<li>åœ¨ <code>renderA</code> é˜¶æ®µï¼Œå€¼ç”± <code>null -&gt; newVal</code>ï¼Œåœ¨ <em>diff</em> æ—¶ï¼Œç”±äºç»‘å®šçš„å€¼ä¸åŒï¼Œäºæ˜¯å°±ç”¨æ–°å€¼å»æ›´æ–°èŠ‚ç‚¹ï¼Œç„¶åé‡æ–°æ¸²æŸ“ã€‚</li>
<li>åœ¨ <code>renderB</code> é˜¶æ®µï¼Œå€¼ç”± <code>newVal -&gt; null</code>ï¼ŒåŒæ ·åœ¨ <em>diff</em> æ—¶ï¼Œæ–°è€èŠ‚ç‚¹è¿˜æ˜¯ä¸åŒçš„ï¼Œä¾ç„¶ç”¨æ–°å€¼å»æ›´æ–°èŠ‚ç‚¹ï¼Œç„¶åé‡æ–°æ¸²æŸ“ã€‚</li>
</ul>
<p>è¿™ä¹Ÿå°±è§£é‡Šå¾—é€šï¼šä¸ºä»€ä¹ˆä½¿ç”¨ <code>$nextTick</code> åå°±èƒ½æ›´æ–°è§†å›¾äº†ï¼ˆåˆå¯¹ <em>Vue</em> åº•å±‚åŠ æ·±äº†ç†è§£ï¼‰ã€‚</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨æŒ‡ä»¤é‡Œå°±èƒ½ç›´æ¥æ›´æ–°å‘¢ï¼ŸğŸ˜‘</p>
<p>æ€€ç–‘æ˜¯å› ä¸ºç»™ <em>InputNumber</em> åŒ…è£¹äº†ä¸€å±‚å¯¼è‡´çš„ï¼Œè€Œä¸”æ˜¯ä»¥ <code>&#123; props: $attrs &#125;</code> çš„å½¢å¼ä¼ é€’çš„å‚æ•°ï¼Œ<code>$attrs</code> è¿˜ä¸æ˜¯å“åº”å¼çš„ï¼Œå½“å†…éƒ¨çš„ <code>$attrs.value</code> å‘ç”Ÿå˜æ¢æ—¶ä¸ä¼šè§¦å‘ <code>render</code>ã€‚äºŒæ¬¡å°è£…ç¬¬ä¸‰æ–¹çš„ç»„ä»¶ï¼Œæ„Ÿè§‰å‘è¿˜å¾ˆå¤šï¼Œä»¥åä¼°è®¡æœ‰å¾—è¸©ã€‚ã€‚ã€‚</p>
<h3 id="æ•´ä½“ä»£ç -1"><a href="#æ•´ä½“ä»£ç -1" class="headerlink" title="æ•´ä½“ä»£ç "></a>æ•´ä½“ä»£ç </h3><blockquote>
<p>åœ¨ <a target="_blank" rel="noopener" href="https://codepen.io/olderk/pen/Baxbdpg">codepen.io</a> ä¸­è¿è¡Œã€‚</p>
</blockquote>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// input-number-union.vue</span>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'input-number-union'</span>
<span class="token keyword">function</span> <span class="token function">setVal</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> keys<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> seqs <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>seqs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    obj<span class="token punctuation">[</span>keys<span class="token punctuation">]</span> <span class="token operator">=</span> val
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> seqs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> key <span class="token operator">=</span> seqs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!==</span> seqs<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        obj <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>
  name<span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">group</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'default'</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">iKey</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
      <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token function">currVal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">.</span>value
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">currMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">.</span>max
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">inputNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">groupName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">-group-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">watcherName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupName<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">-watch</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">groupList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupName<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token function">currVal</span><span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>groupList<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>iKey<span class="token punctuation">]</span> <span class="token operator">=</span> newVal
      <span class="token keyword">const</span> groupListLen <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getGroupListLen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>groupListLen <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>groupListLen <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateOtherKey</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>iKey<span class="token punctuation">,</span> newVal<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">&#125;</span>

      <span class="token keyword">const</span> noEditKeys <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getNoEditKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> noEditKeysLen <span class="token operator">=</span> noEditKeys<span class="token punctuation">.</span>length
      <span class="token comment">// å¦‚æœæ–°å€¼ä¸º null è¯´æ˜æ˜¯æ¸…ç©ºæ“ä½œï¼Œä¸éœ€è¦èµ°ä¸‹é¢çš„é€»è¾‘</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
      <span class="token keyword">const</span> currSum <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCurrSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

      <span class="token comment">// æ±‚å’Œåï¼Œå¤§äºæœ€å¤§å€¼æ—¶ï¼Œèµ‹ç©ºæ‰€æœ‰å€¼</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>currSum <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>currMax<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clearOther</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">&#125;</span>

      <span class="token comment">// å¯¹æœ€åä¸€ä¸ªè¾“å…¥æ¡†è‡ªåŠ¨èµ‹å€¼</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>noEditKeysLen <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">setVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">,</span> noEditKeys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currMax <span class="token operator">-</span> currSum<span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupName<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>iKey<span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupName<span class="token punctuation">]</span> <span class="token operator">||</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupName<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>iKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currVal
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">getCurrSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">sum<span class="token punctuation">,</span> curr</span><span class="token punctuation">)</span> <span class="token operator">=></span> sum <span class="token operator">+</span> curr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">getGroupListLen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupList<span class="token punctuation">)</span><span class="token punctuation">.</span>length
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">getNoEditKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span>groupList<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">updateOtherKey</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>currMax<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">const</span> otherKey <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=></span> v <span class="token operator">!==</span> key<span class="token punctuation">)</span>
      <span class="token function">setVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">,</span> otherKey<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>currMax <span class="token operator">-</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function">clearOther</span><span class="token punctuation">(</span><span class="token parameter">currKey</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>groupList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">!==</span> currKey<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          <span class="token function">setVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'InputNumber'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
      <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">,</span>
        <span class="token literal-property property">activeChange</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">on</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$listeners<span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/3240137ccfb8.html" title="v-resizeï¼šç›‘å¬ DOM å°ºå¯¸å˜åŒ–"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">ä¸Šä¸€é¡µ: v-resizeï¼šç›‘å¬ DOM å°ºå¯¸å˜åŒ–</span></a><a class="button is-default" href="/f956d546f141.html" title="ivu-select-union &lt;W6&gt;"><span class="has-text-weight-semibold">ä¸‹ä¸€é¡µ: ivu-select-union &lt;W6&gt;</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="showlotus/showlotus" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- TODO é…ç½®ä¸ªäººç½‘ç«™é“¾æ¥--><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/showlotus"><i class="iconfont icon-github"></i></a><!-- Gitee--><!-- Ins--><!-- RSS--><!-- çŸ¥ä¹--><!-- é¢†è‹±--><!-- è„¸ä¹¦--></section><p><span>Copyright Â©</span><span> showlotus 2026</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@2.1.4/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"></script><script src="/js/clipboard_use.js"></script><script src="/js/codepen.io.js"></script></body></html>