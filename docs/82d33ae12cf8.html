<!DOCTYPE html><html class="appearance-light" lang="zh-CN"><head><meta charset="UTF-8"><title>v-set-title-attr &lt;W5&gt;</title><meta name="description" content="I hope one day, everyone is using my program."><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="


有个需求，下拉框里的选项分组后，因为组名可能会很长，于是就想添加一个文本超出时显示省略号的样式，这个用 CSS 就能做到，小意思。不过，如果文本超出后，我还想有一个能展示当前文字所有信息的提示。因为本身就是一个浮层了，再添加一个浮层就感觉很怪（说实话也不好加 😂），于是就想用原生的 title 实现（先看效果，如下图所示）。



思路首先可能会想到，把 OptionGroup 上加一个 title 属性，不过这会导致一个问题（以下面的代码为例）：
&amp;lt;Select style=&quot;width:200px&quot;&gt;
  &amp;lt;OptionGroup
    label=&quot;AAAAAAAAAAAAAAAAAAAAAAAA&quot;
    title=&quot;AAAAAAAAAAAAAAAAAAAAAAAA&quot;
  &gt;.."><meta name="generator" content="Hexo 5.4.2"></head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">showlotus's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">v-set-title-attr &lt;W5&gt;</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-text">思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-text">实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-text">代码</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/Vue-%E6%8C%87%E4%BB%A4"><i class="tag post-item-tag">Vue 指令</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">v-set-title-attr &lt;W5&gt;</h1><time class="has-text-grey custom-date-font" datetime="2022-10-02T19:22:29.000Z">2022/10/02 19:22</time><article class="mt-2 post-content"><img src="/82d33ae12cf8/banner.jpg" class="">

<blockquote>
<p>有个需求，下拉框里的选项分组后，因为组名可能会很长，于是就想添加一个文本超出时显示省略号的样式，这个用 CSS 就能做到，小意思。不过，如果文本超出后，我还想有一个能展示当前文字所有信息的提示。因为本身就是一个浮层了，再添加一个浮层就感觉很怪（说实话也不好加 😂），于是就想用原生的 title 实现（先看效果，如下图所示）。</p>
</blockquote>
<img src="/82d33ae12cf8/result.gif" class="">

<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>首先可能会想到，把 <em>OptionGroup</em> 上加一个 <em>title</em> 属性，不过这会导致一个问题（以下面的代码为例）：</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Select style<span class="token operator">=</span><span class="token string">"width:200px"</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>OptionGroup
    label<span class="token operator">=</span><span class="token string">"AAAAAAAAAAAAAAAAAAAAAAAA"</span>
    title<span class="token operator">=</span><span class="token string">"AAAAAAAAAAAAAAAAAAAAAAAA"</span>
  <span class="token operator">></span>
    <span class="token operator">&lt;</span>Option v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"item in cityList1"</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"item.value"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"item.value"</span><span class="token operator">></span>
      <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>label <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>OptionGroup<span class="token operator">></span>
  <span class="token operator">&lt;</span>OptionGroup
    label<span class="token operator">=</span><span class="token string">"BBBBBBBBBBBBBBBBBBBBBBBB"</span>
    title<span class="token operator">=</span><span class="token string">"BBBBBBBBBBBBBBBBBBBBBBBB"</span>
  <span class="token operator">></span>
    <span class="token operator">&lt;</span>Option v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"item in cityList2"</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"item.value"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"item.value"</span><span class="token operator">></span>
      <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>label <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>OptionGroup<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token operator">></span></code></pre>

<img src="/82d33ae12cf8/problem.gif" class="">

<p>首先要清楚 <em>title</em> 生效的范围，给元素加上这个属性后，只要是在这个元素的区域内，鼠标移入都会有这个 <em>title</em> 的提示。所以，鼠标在移入每个 <em>Option</em> 上时，出现这个提示，也没毛病。不过，这给用户就会有误导，明明 <em>Option</em> 中的文本是这个，提示出来的却是另一个。所以，这个方法有瑕疵，不可取 🙁。</p>
<p>先想一想上面的问题，归根结底是没有把 <em>title</em> 加到真正的组名上。翻了翻 <em>OptionGroup</em> 的内部实现，也没有关于 <em>label</em> 的插槽什么的，就是单纯的一个 <code>div</code>。显然，通过组件自身提供的一些属性已经不能达到我们的目的了。我们需要找到那个组名对应的 <em>DOM</em> 节点，然后给这个节点添加一个 <em>title</em> 的属性。给 <em>DOM</em> 节点设置属性，那就需要用到一个方法： <em><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/setAttribute">Element.setAttribute()</a></em> 。</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>通过上面的分析，我们需要得到组名对应的那个 <em>DOM</em> 节点，在 <em>Vue</em> 中操作原生 <em>DOM</em> ，你是不是想到了指令。指令的生命周期方法中的第一个参数（<code>el</code>）就是当前的 <em>DOM</em> 节点。当然，这个 <em>el</em> 不一定就是组名的 <em>DOM</em> 节点（在控制台打印一下就能知道了），如果不是，那组名的 <em>DOM</em> 一定是 <em>el</em> 的子元素，所以我们需要在 <em>el</em> 中查找组名的 <em>DOM</em> 节点，在当前节点下查找后代节点，就需要用到另一个方法： <em><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/querySelector">Element.querySelector()</a></em> 。</p>
<p>打开控制台，查看一下组名的 <em>DOM</em> 节点的 <em>class</em> （<code>ivu-select-group-title</code>），然后我们只需要按照下面的代码，就能给组名的 <em>DOM</em> 添加一个 <em>title</em> 属性了。</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript">el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".ivu-select-group-title"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"AAA"</span><span class="token punctuation">)</span></code></pre>

<p>归纳一下，把这个指令做得更通用一点，把那些容易变化的部分做成变量，在使用指令时传入。这里只有 <em>class</em> 与 <em>title</em> 需要外部传入。<em>title</em> 可以写在指令绑定的值中，而 <em>class</em> 可以用指令的 <em>arg</em> 传入。也即：<code>v-set-title-attr:ivu-select-group-title=&quot;title&quot;</code>。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>最后的整体代码，很简短。</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">directives</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">setTitleAttr</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding<span class="token punctuation">,</span> vnode</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> value<span class="token punctuation">,</span> arg <span class="token punctuation">&#125;</span> <span class="token operator">=</span> binding
        <span class="token comment">// 判断是否传入了 arg</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
          el <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>arg<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>使用：</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Select style<span class="token operator">=</span><span class="token string">"width:200px"</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>OptionGroup
    label<span class="token operator">=</span><span class="token string">"AAAAAAAAAAAAAAAAAAAAAAAA"</span>
    v<span class="token operator">-</span>set<span class="token operator">-</span>title<span class="token operator">-</span>attr<span class="token operator">:</span>ivu<span class="token operator">-</span>select<span class="token operator">-</span>group<span class="token operator">-</span>title<span class="token operator">=</span><span class="token string">"'AAAAAAAAAAAAAAAAAAAAAAAA'"</span>
  <span class="token operator">></span>
    <span class="token operator">&lt;</span>Option v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"item in cityList1"</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"item.value"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"item.value"</span><span class="token operator">></span>
      <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>label <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>OptionGroup<span class="token operator">></span>
  <span class="token operator">&lt;</span>OptionGroup
    label<span class="token operator">=</span><span class="token string">"BBBBBBBBBBBBBBBBBBBBBBBB"</span>
    v<span class="token operator">-</span>set<span class="token operator">-</span>title<span class="token operator">-</span>attr<span class="token operator">:</span>ivu<span class="token operator">-</span>select<span class="token operator">-</span>group<span class="token operator">-</span>title<span class="token operator">=</span><span class="token string">"'BBBBBBBBBBBBBBBBBBBBBBBB'"</span>
  <span class="token operator">></span>
    <span class="token operator">&lt;</span>Option v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"item in cityList2"</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">"item.value"</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">"item.value"</span><span class="token operator">></span>
      <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> item<span class="token punctuation">.</span>label <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>OptionGroup<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token operator">></span></code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/f956d546f141.html" title="ivu-select-union &lt;W6&gt;"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: ivu-select-union &lt;W6&gt;</span></a><a class="button is-default" href="/db10bdbda40c.html" title="一周年啦！"><span class="has-text-weight-semibold">下一页: 一周年啦！</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="showlotus/showlotus" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- TODO 配置个人网站链接--><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/showlotus"><i class="iconfont icon-github"></i></a><!-- Gitee--><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> showlotus 2025</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@2.1.4/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"></script><script src="/js/clipboard_use.js"></script><script src="/js/codepen.io.js"></script></body></html>